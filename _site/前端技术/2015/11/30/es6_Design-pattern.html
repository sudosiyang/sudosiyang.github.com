<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>
			ES6 实现几种 设计模式 -

			苏思洋的博客 </title>

		<meta name="author" content="susu">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<!-- HTML5 shim, for IE6-8 support of HTML elements -->
		<!--[if lt IE 9]>
		<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]-->

		<link href="/assets/style.min.css?body=3.3.1" rel="stylesheet" type="text/css" media="all">
		<link rel="alternate" type="application/rss+xml" title="RSS 2.0 - 所有文章" href="feed.xml" />
		<link rel="alternate" type="application/atom+xml" href="atom.xml" title="Atom feed">
		<!-- fav and touch icons -->
		<!-- Update these with your own images
		<link rel="shortcut icon" href="images/favicon.ico">
		<link rel="apple-touch-icon" href="images/apple-touch-icon.png">
		<link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
		<link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
		-->
	</head>

	<body>
		<div class="navbar">
			<img id="profile" src="/blog-assets/susu.jpg" alt="susu" class="rollIn animated">
			<ul class="nav">













		<li id="label1" class="labels"><a href="/">

				最新文章

		</a></li>








		<li id="label2" class="labels"><a href="/other">

				杂谈

		</a></li>









				<li id="label3" class="active labels"><a href="/qianduan" class="active">前端技术</a></li>














		<li id="label4" class="labels"><a href="/tec_css">

				交互设计

		</a></li>








		<li id="label5" class="labels"><a href="/view_des">

				视觉设计

		</a></li>








			</ul>
			<div class="f_like">
			<div>友链</div>
			<ul class="links">

                 <li class="link"><a href="http://hyq.me" title="hyq">hyq</a></li>

                 <li class="link"><a href="http://catalystdp.github.io/" title="catalystdp">catalystdp</a></li>

			</ul>
			</div>
		</div>
		<div id="sidebar">
			<div id="title_wrap" class=" title3">
				<h2 class="title">










							前端技术








				</h2>
			</div>


					<ul class="posts">








      	<li><a class="cate title3" href="/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF/2015/12/01/web_build"><span class="circle_icon"></span>前端工程化技能树整理<span class='date'>01 Dec 2015</span></a></li>







      	<li class="active"><a class="cate title3" href="/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF/2015/11/30/es6_Design-pattern" class="active"><span class="circle_icon"></span>ES6 实现几种 设计模式<span class='date'>30 Nov 2015</span></a></li>







      	<li><a class="cate title3" href="/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF/2015/11/23/es7_decorator"><span class="circle_icon"></span>ES7 Decorator 装饰者模式 浅出<span class='date'>23 Nov 2015</span></a></li>







      	<li><a class="cate title3" href="/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF/2015/11/10/requestAnimationFrame"><span class="circle_icon"></span>requestAnimationFrame 详解<span class='date'>10 Nov 2015</span></a></li>







      	<li><a class="cate title3" href="/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF/2015/05/14/css_BFC"><span class="circle_icon"></span>BFC 神奇背后的原理<span class='date'>14 May 2015</span></a></li>







      	<li><a class="cate title3" href="/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF/2015/05/12/js-opt"><span class="circle_icon"></span>前端性能优化实践<span class='date'>12 May 2015</span></a></li>







      	<li><a class="cate title3" href="/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF/2015/04/29/learn-web"><span class="circle_icon"></span>2015年值得关注的几个WEB技术<span class='date'>29 Apr 2015</span></a></li>







      	<li><a class="cate title3" href="/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF/2015/04/10/HTTP_API"><span class="circle_icon"></span>HTTP API 设计指南<span class='date'>10 Apr 2015</span></a></li>







      	<li><a class="cate title3" href="/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF/2015/04/09/html_guid"><span class="circle_icon"></span>HTML编码规范<span class='date'>09 Apr 2015</span></a></li>







      	<li><a class="cate title3" href="/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF/2015/03/31/less_guide"><span class="circle_icon"></span>Less规范<span class='date'>31 Mar 2015</span></a></li>







      	<li><a class="cate title3" href="/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF/2015/03/31/javascript_guide"><span class="circle_icon"></span>JavaScript规范<span class='date'>31 Mar 2015</span></a></li>







      	<li><a class="cate title3" href="/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF/2015/03/31/css_guide"><span class="circle_icon"></span>CSS规范<span class='date'>31 Mar 2015</span></a></li>







      	<li><a class="cate title3" href="/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF/2015/03/16/javascript_tip"><span class="circle_icon"></span>前端小技巧总结<span class='date'>16 Mar 2015</span></a></li>







      	<li><a class="cate title3" href="/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF/2015/03/13/pm2"><span class="circle_icon"></span>用pm2管理node进程<span class='date'>13 Mar 2015</span></a></li>







      	<li><a class="cate title3" href="/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF/2015/03/13/pm2-web"><span class="circle_icon"></span>pm2-web监控node.js应用服务状态<span class='date'>13 Mar 2015</span></a></li>







      	<li><a class="cate title3" href="/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF/2014/08/13/nodejs_update"><span class="circle_icon"></span>node.js升级<span class='date'>13 Aug 2014</span></a></li>







      	<li><a class="cate title3" href="/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF/2014/04/11/Canvas_API"><span class="circle_icon"></span>Canvas API<span class='date'>11 Apr 2014</span></a></li>







      	<li><a class="cate title3" href="/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF/2014/01/21/html-zhuanyi"><span class="circle_icon"></span>JavaScript 的HTML转义方法<span class='date'>21 Jan 2014</span></a></li>







      	<li><a class="cate title3" href="/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF/2014/01/09/IE-iframe-P3P"><span class="circle_icon"></span>IE下iframe跨域session丢失问题和解决<span class='date'>09 Jan 2014</span></a></li>







      	<li><a class="cate title3" href="/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF/2013/11/26/cross-domian"><span class="circle_icon"></span>JavaScript 跨域访问的问题和解决过程<span class='date'>26 Nov 2013</span></a></li>







      	<li><a class="cate title3" href="/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF/2013/11/07/javascript-tip"><span class="circle_icon"></span>javascript 小技巧<span class='date'>07 Nov 2013</span></a></li>







      	<li><a class="cate title3" href="/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF/2013/10/25/31CSS"><span class="circle_icon"></span>31 种 CSS 选择器用法<span class='date'>25 Oct 2013</span></a></li>







      	<li><a class="cate title3" href="/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF/2013/10/05/Responsive_Web_Design_step"><span class="circle_icon"></span>复杂产品的响应式设计【流程篇】<span class='date'>05 Oct 2013</span></a></li>







      	<li><a class="cate title3" href="/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF/2013/10/05/Responsive_Web_Design"><span class="circle_icon"></span>响应式网页设计<span class='date'>05 Oct 2013</span></a></li>







      	<li><a class="cate title3" href="/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF/2013/10/03/qianduan"><span class="circle_icon"></span>前端的困局与突围(from 玉伯)<span class='date'>03 Oct 2013</span></a></li>







      	<li><a class="cate title3" href="/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF/2013/10/03/markdown"><span class="circle_icon"></span>如何使用markdown<span class='date'>03 Oct 2013</span></a></li>







					</ul>











		</div>
		<div id="container">
			<button class="navbar-toggle" type="button">
		        <span class="icon-bar"></span>
		        <span class="icon-bar"></span>
		        <span class="icon-bar"></span>
      		</button>
			<div id="pjax">
				<article id="post" class="title3">
					<header id="header">
						<h1 id="identifier">
								ES6 实现几种 设计模式
						</h1>
					</header>
					<div id="content">
						<p>最近将部分项目从ES5转换到了ES6,从新的语法中体会到了很多。无论是可读性还是代码量方面都有很大改善。既然引入了es6，那设计模式的实现方法就需要重新写一遍了。</p>

<h3 id="单例模式">单例模式</h3>

<div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="s1">'use strict'</span><span class="p">;</span>
<span class="kd">let</span> <span class="nx">__instance</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="kd">let</span> <span class="nx">instance</span><span class="p">;</span>
  <span class="k">return</span> <span class="p">(</span><span class="nx">_instance</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">_instance</span><span class="p">)</span> <span class="nx">instance</span> <span class="o">=</span> <span class="nx">_instance</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">instance</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">})();</span>

<span class="kr">class</span> <span class="nx">Singleton</span> <span class="p">{</span>
  <span class="nx">constructor</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">__instance</span><span class="p">())</span> <span class="k">return</span> <span class="nx">__instance</span><span class="p">();</span>
    <span class="c1">// todo init</span>
    <span class="nx">__instance</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">new</span> <span class="nx">Singleton</span><span class="p">()</span> <span class="o">==</span> <span class="k">new</span> <span class="nx">Singleton</span><span class="p">())</span>
</code></pre>
</div>

<h3 id="工厂模式">工厂模式</h3>

<div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="s1">'use strict'</span><span class="p">;</span>
<span class="kr">class</span> <span class="nx">Car</span><span class="p">{</span>
  <span class="nx">constructor</span><span class="p">(){</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">door</span><span class="o">=</span><span class="mi">4</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="kr">static</span> <span class="nx">fatcory</span><span class="p">(</span><span class="nx">type</span><span class="p">){</span>
      <span class="k">return</span> <span class="k">new</span> <span class="nx">Car</span><span class="p">[</span><span class="nx">type</span><span class="p">]();</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="nx">Car</span><span class="p">.</span><span class="nx">Trunk</span> <span class="o">=</span> <span class="kr">class</span> <span class="nx">Trunk</span> <span class="kr">extends</span> <span class="nx">Car</span><span class="p">{</span>
    <span class="nx">constructor</span><span class="p">(){</span>
      <span class="kr">super</span><span class="p">();</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">door</span><span class="o">=</span><span class="mi">2</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">Car</span><span class="p">.</span><span class="nx">fatcory</span><span class="p">(</span><span class="s2">"Trunk"</span><span class="p">).</span><span class="nx">door</span><span class="p">)</span>
</code></pre>
</div>

<h3 id="代理模式">代理模式</h3>

<blockquote>
  <p>使用代理模式创建代理对象，让代理对象控制目标对象的访问(目标对象可以是远程的对象、创建开销大的对象或需要安全控制的对象),并且可以在不改变目标对象的情况下添加一些额外的功能。</p>
</blockquote>

<div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="s1">'use strict'</span><span class="p">;</span>
<span class="kr">class</span> <span class="nx">Real</span> <span class="p">{</span>
  <span class="nx">toDo</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="err">`</span><span class="nx">to</span> <span class="k">do</span> <span class="nx">something</span><span class="p">...</span><span class="err">`</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kr">class</span> <span class="nx">Proxy</span> <span class="kr">extends</span> <span class="nx">Real</span> <span class="p">{</span>
  <span class="nx">constructor</span><span class="p">()</span> <span class="p">{</span>
    <span class="kr">super</span><span class="p">();</span>
  <span class="p">}</span>

  <span class="nx">toDo</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">setTimeout</span><span class="p">(</span><span class="kr">super</span><span class="p">.</span><span class="nx">toDo</span><span class="p">,</span> <span class="mi">1000</span> <span class="o">*</span> <span class="nx">N</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="k">new</span> <span class="nx">Proxy</span><span class="p">().</span><span class="nx">toDo</span><span class="p">();</span> <span class="c1">//N s后, to do...</span>

</code></pre>
</div>

<h3 id="迭代模式">迭代模式</h3>

<blockquote>
  <p>提供一种方法顺序访问一个聚合对象中的各种元素，而又不暴露该对象的内部表示</p>
</blockquote>

<div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="s1">'use strict'</span><span class="p">;</span>
<span class="kd">let</span> <span class="nx">array</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">data</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
  <span class="p">[</span><span class="nx">Symbol</span><span class="p">.</span><span class="nx">iterator</span><span class="p">](){</span>
    <span class="kd">let</span> <span class="nx">index</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">return</span> <span class="p">{</span>
      <span class="na">next</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">index</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="k">return</span> <span class="p">{</span><span class="na">value</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="nx">index</span><span class="o">++</span><span class="p">],</span> <span class="na">done</span><span class="p">:</span> <span class="kc">false</span><span class="p">};</span>
        <span class="k">return</span> <span class="p">{</span><span class="na">value</span><span class="p">:</span> <span class="kc">undefined</span><span class="p">,</span> <span class="na">done</span><span class="p">:</span> <span class="kc">true</span><span class="p">};</span>
      <span class="p">},</span>
      <span class="na">hasNext</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">index</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span>
      <span class="na">rewind</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">index</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
      <span class="na">current</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">index</span> <span class="o">-=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">index</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="k">return</span> <span class="p">{</span><span class="na">value</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="nx">index</span><span class="o">++</span><span class="p">],</span> <span class="na">done</span><span class="p">:</span> <span class="kc">false</span><span class="p">};</span>
        <span class="k">return</span> <span class="p">{</span><span class="na">value</span><span class="p">:</span> <span class="kc">undefined</span><span class="p">,</span> <span class="na">done</span><span class="p">:</span> <span class="kc">true</span><span class="p">};</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="c1">// for...of</span>
<span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">val</span> <span class="nx">of</span> <span class="nx">array</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">val</span><span class="p">);</span>
<span class="p">}</span>
</code></pre>
</div>

<h3 id="装饰者模式">装饰者模式</h3>

<blockquote>
  <p>在不改变原类和继承的情况下动态扩展对象功能，通过包装一个对象来实现一个新的具有原对象相同接口的新的对象</p>
</blockquote>

<div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="s1">'use strict'</span><span class="p">;</span>
<span class="kr">class</span> <span class="nx">Equipments</span><span class="p">{</span>
  <span class="kr">static</span> <span class="nx">loricae</span><span class="p">(</span><span class="nx">hero</span><span class="p">){</span>
    <span class="nx">hero</span><span class="p">.</span><span class="nx">defence</span> <span class="o">+=</span> <span class="mi">15</span><span class="p">;</span>
    <span class="nx">hero</span><span class="p">.</span><span class="nx">hp</span> <span class="o">+=</span> <span class="mi">200</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="kr">static</span> <span class="nx">glaive</span><span class="p">(</span><span class="nx">hero</span><span class="p">){</span>
    <span class="nx">hero</span><span class="p">.</span><span class="nx">attcak</span> <span class="o">+=</span> <span class="mi">40</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kr">class</span> <span class="nx">Hero</span> <span class="p">{</span>
  <span class="nx">constructor</span><span class="p">({</span><span class="nx">def</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span><span class="nx">atk</span> <span class="o">=</span> <span class="mi">70</span><span class="p">,</span><span class="nx">hp</span> <span class="o">=</span> <span class="mi">630</span><span class="p">}</span> <span class="o">=</span> <span class="p">{})</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">hp</span> <span class="o">=</span> <span class="nx">hp</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">attcak</span> <span class="o">=</span> <span class="nx">atk</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">defence</span> <span class="o">=</span> <span class="nx">def</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nx">toString</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="err">`防御力:</span><span class="nx">$</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">defence</span><span class="p">},</span><span class="err">攻击力:</span><span class="nx">$</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">attcak</span><span class="p">},</span><span class="err">血量:</span><span class="nx">$</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">hp</span><span class="p">}</span><span class="err">`</span><span class="p">;;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kd">let</span> <span class="nx">hero</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Hero</span><span class="p">();</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">hero</span><span class="p">);</span> <span class="c1">//{"hp":630,"attcak":70,"defence":30}</span>

<span class="nx">Equipments</span><span class="p">.</span><span class="nx">loricae</span><span class="p">(</span><span class="nx">hero</span><span class="p">)</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">hero</span><span class="p">);</span> <span class="c1">//{"hp":830,"attcak":70,"defence":45}</span>

<span class="nx">Equipments</span><span class="p">.</span><span class="nx">glaive</span><span class="p">(</span><span class="nx">hero</span><span class="p">)</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">hero</span><span class="p">);</span> <span class="c1">//{"hp":830,"attcak":110,"defence":45}</span>
</code></pre>
</div>

<h3 id="订阅发布模式">订阅/发布模式</h3>

<blockquote>
  <p>发布-订阅（publish–subscribe）是一种消息传播模式，消息的发送者（发布者）不会将消息直接发送给特定的接收者（订阅者）。而是将发布的消息按特征分类，无需对订阅者（如果有的话）有所了解。同样的，订阅者可以表达对一个或多个类别的兴趣，只接收感兴趣的消息，无需对发布者（如果有的话）有所了解。</p>
</blockquote>

<div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="s1">'use strict'</span><span class="p">;</span>
<span class="kr">class</span> <span class="nx">Event</span> <span class="p">{</span>
  <span class="nx">constructor</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">subscribers</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Map</span><span class="p">([[</span><span class="s1">'any'</span><span class="p">,</span> <span class="p">[]]]);</span>
  <span class="p">}</span>

  <span class="nx">on</span><span class="p">(</span><span class="nx">type</span> <span class="o">=</span> <span class="s1">'any'</span><span class="p">,</span><span class="nx">fn</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">subs</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">subscribers</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">subs</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">type</span><span class="p">))</span> <span class="k">return</span> <span class="nx">subs</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">type</span><span class="p">,</span> <span class="p">[</span><span class="nx">fn</span><span class="p">]);</span>
    <span class="nx">subs</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">type</span><span class="p">,</span> <span class="p">(</span><span class="nx">subs</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">type</span><span class="p">).</span><span class="nx">push</span><span class="p">(</span><span class="nx">fn</span><span class="p">)));</span>
  <span class="p">}</span>

  <span class="nx">emit</span><span class="p">(</span><span class="nx">type</span> <span class="o">=</span> <span class="s1">'any'</span><span class="p">,</span> <span class="p">...</span><span class="nx">agrs</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">fn</span> <span class="nx">of</span> <span class="k">this</span><span class="p">.</span><span class="nx">subscribers</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">type</span><span class="p">))</span> <span class="p">{</span>
      <span class="nx">fn</span><span class="p">(...</span><span class="nx">agrs</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kd">let</span> <span class="nx">event</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Event</span><span class="p">();</span>

<span class="nx">event</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">"click"</span><span class="p">,(</span><span class="nx">e</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="err">`</span><span class="nx">click</span> <span class="nx">Dom</span><span class="err">:</span> <span class="nx">$</span><span class="p">{</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">}</span><span class="err">`</span><span class="p">));</span>
<span class="nx">event</span><span class="p">.</span><span class="nx">emit</span><span class="p">(</span><span class="s1">'click'</span><span class="p">,{</span><span class="na">target</span><span class="p">:</span><span class="s2">"div"</span><span class="p">});</span> <span class="c1">//click Dom: div</span>
</code></pre>
</div>

<h3 id="命令模式">命令模式</h3>
<blockquote>
  <p>命令模式将一个请求或者操作封装到一个对象中。命令模式将发出命令和执行命令的责任分割开，委派给不同的对象。命令模式也允许请求方个接受方相互独立，使得请求方不需要知道接收方的接口等。</p>
</blockquote>

<p>e.g.在富文本编辑器中:</p>

<div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="s1">'use strict'</span><span class="p">;</span>
<span class="kr">class</span> <span class="nx">Cmd</span><span class="p">{</span>
  <span class="nx">constructor</span><span class="p">(){</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">execList</span><span class="o">=</span><span class="p">[];</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">cmds</span><span class="o">=</span><span class="p">{</span>
      <span class="na">blod</span><span class="p">:</span><span class="kd">function</span><span class="p">(){},</span>
      <span class="na">font_family</span><span class="p">:</span><span class="kd">function</span><span class="p">(){},</span>
      <span class="na">font_color</span><span class="p">:</span><span class="kd">function</span><span class="p">(){},</span>
      <span class="na">code</span><span class="p">:</span><span class="kd">function</span><span class="p">(){}</span>
      <span class="c1">//等等</span>
      <span class="p">};</span><span class="c1">//命令集合</span>
  <span class="p">}</span>
  <span class="nx">exec</span><span class="p">(</span><span class="nx">cmd</span><span class="p">,...</span><span class="nx">args</span><span class="p">){</span>
    <span class="kd">let</span> <span class="nx">command</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">cmds</span><span class="p">[</span><span class="nx">cmd</span><span class="p">];</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">command</span><span class="p">){</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">execList</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
        <span class="na">cmd</span><span class="p">:</span><span class="nx">cmd</span><span class="p">,</span>
        <span class="na">args</span><span class="p">:</span><span class="nx">args</span>
      <span class="p">});</span>
      <span class="nx">command</span><span class="p">(</span><span class="nx">args</span><span class="p">)</span>
    <span class="p">}</span>

  <span class="p">}</span>

  <span class="nx">undo</span><span class="p">(){</span>
    <span class="kd">let</span> <span class="nx">handle</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">execList</span><span class="p">.</span><span class="nx">pop</span><span class="p">();</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">handle</span><span class="p">)</span>
    <span class="c1">//do something;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kd">let</span> <span class="nx">cmd</span><span class="o">=</span><span class="k">new</span> <span class="nx">Cmd</span><span class="p">()</span>
<span class="nx">cmd</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="s2">"blod"</span><span class="p">);</span>
<span class="nx">cmd</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="s2">"code"</span><span class="p">,</span><span class="s2">"let a;"</span><span class="p">);</span>
<span class="nx">cmd</span><span class="p">.</span><span class="nx">undo</span><span class="p">();</span>
</code></pre>
</div>

<p>先介绍这么多。。有时间在更新吧！</p>

					</div>
				</article>
			</div>
			<!-- Duoshuo Comment BEGIN -->
	<div class="ds-thread">

<div id="bdshare" class="bdshare_t bds_tools get-codes-bdshare">
<a class="bds_tsina"></a>
<a class="bds_tqq"></a>
<a class="bds_renren"></a>
<a class="bds_hi"></a>
<span class="bds_more">更多</span>
</div>
<script type="text/javascript" id="bdshare_js" data="type=tools&amp;mini=1&amp;uid=6840238" ></script>
<script type="text/javascript" id="bdshell_js"></script>
<script type="text/javascript">
document.getElementById("bdshell_js").src = "http://bdimg.share.baidu.com/static/js/shell_v2.js?cdnversion=" + Math.ceil(new Date()/3600000)
</script>
	</div>
<script type="text/javascript">
var duoshuoQuery = {short_name:"susiyang"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = 'http://static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0]
		|| document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
<!-- Duoshuo Comment END -->

		</div>
<script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.10.2.min.js"></script>
<script src="/assets/index.min.js?body=4.0.0"></script>
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Ffbcbbadeaf00526725e0f222ba832804' type='text/javascript'%3E%3C/script%3E"));
</script>
	</body>
</html>
